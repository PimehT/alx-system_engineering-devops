#!/usr/bin/env bash
# configuring nginx server so /redirect_me is redirecting
#+ to another page using 301 (permanent redirection)

./1-install_nginx_web_server

read -r -d '' REDIRECT_RULE <<'EOF'
location /redirect_me/ {
    return 301 https://www.youtube.com/watch?v=QH2-TGUlwu4;
}
EOF

NGINX_CONFIG="/etc/nginx/sites-available/default"
if [ -f "$NGINX_CONFIG" ]; then
    cp /etc/nginx/sites-available/default /etc/nginx/sites-available/default.bak
    echo "$REDIRECT_RULE" >> "$NGINX_CONFIG"
else
    echo "Default server block configuration file not found"
    exit 1
fi

service nginx reload